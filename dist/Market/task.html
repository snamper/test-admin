<form name=add ng-submit=taskCtrl.AddTask()><div class=task><div class="panel panel-default panel-border"><div class=panel-heading>活动基本信息</div><div class=panel-body><div class=form-group ng-class="{'has-error':add.name.$error.required&&add.name.$touched}"><label>活动名称</label> <input type=text name=name class=form-control required placeholder=请输入活动名称 ng-model=taskCtrl.task.name><p class=error-text ng-if=add.name.$error.required&&add.name.$touched>名称不能为空</p></div><div class=form-group ng-class="{'has-error':add.enabled.$error.required&&add.enabled.$touched}"><label>是否有效</label><select required class="form-control w200p" name=enabled ng-model=taskCtrl.task.enabled><option selected>请选择</option><option value=true>是</option><option value=false>否</option></select><p class=error-text ng-if=add.enabled.$error.required&&add.enabled.$touched>选项为必填</p></div><div class=form-group ng-class="{'has-error':add.priority.$error.required&&add.priority.$touched}"><label>活动优先级</label> <input type=number class=form-control name=priority required ng-model=taskCtrl.task.priority placeholder=请输入优先级范围(1~120)><p class=error-text ng-if=add.priority.$error.required&&add.priority.$touched>优先级为正整数且不能为空！</p></div><div class=form-group ng-class="{'has-error':add.exclusives.$error.required&&add.exclusives.$touched}"><label>活动排他性</label><select name=exclusives required class="form-control w200p" ng-model=taskCtrl.task.exclusive><option selected hidden>请选择</option><option value=true>是</option><option value=false>否</option></select><p class=error-text ng-if=add.exclusives.$error.required&&add.exclusives.$touched>选项为必填</p></div><div class=form-group ng-class="{'has-error':add.description.$error.required&&add.description.$touched}"><label>活动简介</label> <textarea name=description required class=form-control ng-model=taskCtrl.task.description cols=30 rows=10></textarea><p class=error-text ng-if=add.description.$error.required&&add.description.$touched>选项为必填</p></div><div class=form-group ng-class="{'has-error':add.userType.$error.required&&add.userType.$touched}"><label>用户范围</label><select name=userType required class="form-control w200p" ng-model=taskCtrl.task.userType><option selected hidden>请选择</option><option value=ALL_USER>全部用户</option><option value=NEW_USER>新注册用户</option></select><p class=error-text ng-if=add.userType.$error.required&&add.userType.$touched>选项为必填</p></div><div class=form-group ng-class="{'has-error':add.storeType.$error.required&&add.storeType.$touched}"><label>门店范围</label><select name=storeType required class="form-control w200p" ng-model=taskCtrl.task.storeType><option selected hidden>请选择</option><option value=ALL_STORE>全部门店</option><option value=SELECTED_STORE>部分门店</option></select><p class=error-text ng-if=add.storeType.$error.required&&add.storeType.$touched>选项为必填</p></div><stores ng-show="taskCtrl.task.storeType=='SELECTED_STORE'" returnlist=taskCtrl.task.storesId></stores><div class=form-group><label>有效日期</label><div><div class="dropdown dib" style=width:400px;><a class=dropdown-toggle id=dropdown1 role=button data-toggle=dropdown data-target=# href=javascript:;><div class=input-group><span class=input-group-addon>开始时间</span> <input type=text class=form-control name=startTime required data-ng-model="taskCtrl.task.startTime | date:'yyyy-MM-dd HH:mm'"><span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=taskCtrl.task.startTime modeltype=Date date=Date data-datetimepicker-config="{ dropdownSelector: '#dropdown1' }"></datetimepicker></ul><p class=error-text ng-if=add.startTime.$error.required&&add.startTime.$touched>选项为必填</p></div><div class="dropdown dib" style=width:400px;><a class=dropdown-toggle id=dropdown2 role=button data-toggle=dropdown data-target=# href=javascript:;><div class=input-group><span class=input-group-addon>结束时间</span> <input type=text class=form-control name=endTime required data-ng-model="taskCtrl.task.endTime | date:'yyyy-MM-dd HH:mm'"><span class=input-group-addon><i class="glyphicon glyphicon-calendar"></i></span></div></a><ul class=dropdown-menu role=menu aria-labelledby=dLabel><datetimepicker data-ng-model=taskCtrl.task.endTime data-datetimepicker-config="{ dropdownSelector: '#dropdown2' }"></datetimepicker></ul><p class=error-text ng-if=add.endTime.$error.required&&add.endTime.$touched>选项为必填</p></div></div></div><div class=form-group ng-class="{'has-error':add.timesLimitType.$error.required&&add.timesLimitType.$touched}"><label>参与次数</label><select name=timesLimitType required class="form-control w200p" ng-model=taskCtrl.task.timesLimitType><option selected hidden>请选择</option><option value=NO_LIMIT>无限制</option><option value=CONTINUOUS>限制次数</option><option value=RECURRENT>限制周期</option></select><p class=error-text ng-if=add.timesLimitType.$error.required&&add.timesLimitType.$touched>选项为必填</p></div><div class=form-group ng-if="taskCtrl.task.timesLimitType=='CONTINUOUS'" ng-class="{'has-error':add.timesLimit.$error.required&&add.timesLimit.$touched}"><label>参与次数</label><div class=input><div class=input-tit>只可参加</div><input name=timesLimit type=text required class="input-text w50p" ng-model=taskCtrl.task.timesLimit><div class=input-tit>次</div></div><p class=error-text ng-if=add.timesLimit.$error.required&&add.timesLimit.$touched>选项为必填</p></div><div class=form-group ng-if="taskCtrl.task.timesLimitType=='RECURRENT'" ng-class="{'has-error':(add.timesLimitType.$error.required&&add.timesLimitType.$touched)||(add.timesLimit.$error.required&&add.timesLimit.$touched)}"><label>参与次数</label><div class=input><div class=input-tit>周期天数</div><input type=text name=timesLimitCycle required ng-model=taskCtrl.task.timesLimitCycle class="input-text w50p"><div class=input-tit>天内参加次数</div><input type=text name=timesLimit required class="input-text w50p" ng-model=taskCtrl.task.timesLimit><div class=input-tit>次</div></div><p class=error-text ng-if=(add.timesLimitCycle.$error.required&&add.timesLimitCycle.$touched)||(add.timesLimit.$error.required&&add.timesLimit.$touched)>内容为必填</p></div><div class=form-group ng-class="{'has-error':add.productType.$error.required&&add.productType.$touched}"><label>选择促销商品范围</label><select name=productType required class="form-control w200p" ng-model=taskCtrl.task.productType><option selected hidden>请选择</option><option value=ALL_PRODUCT>全场通用</option><option value=SELECTED_PRODUCT>限定单品</option></select><p class=error-text ng-if=add.productType.$error.required&&add.productType.$touched>选项为必填</p></div><goods returnlist=taskCtrl.task.goodsId ng-show="taskCtrl.task.productType=='SELECTED_PRODUCT'"></goods><div class=form-group ng-if="taskCtrl.task.productType=='SELECTED_PRODUCT'" ng-class="{'has-error':add.isBuy.$error.required&&add.isBuy.$touched}"><label>是否商品限购</label><select name=isBuy required class="form-control w200p" ng-model=taskCtrl.task.isBuy><option selected hidden>请选择</option><option value=true>是</option><option value=false>否</option></select><p class=error-text ng-if=add.isBuy.$error.required&&add.isBuy.$touched>选项为必填</p></div><div class=form-group ng-if="taskCtrl.task.isBuy.$view=='true'" ng-class="{'has-error':add.isBuy.$error.required&&add.isBuy.$touched}"><label>限购次数</label><div class=input><div class=input-tit>最多可购</div><input type=text class="input-text w50p" ng-model=taskCtrl.task.productCountLimit><div class=input-tit>次</div></div><p class=error-text ng-if=add.isBuy.$error.required&&add.isBuy.$touched>选项为必填</p></div><div class=form-group ng-class="{'has-error':add.isGood.$error.required&&add.isGood.$touched}"><label>活动促销方式</label><select name=isGood required class="form-control w200p" ng-model=taskCtrl.task.isGood><option selected hidden>请选择</option><option value=false>订单无关</option><option value=true>订单相关</option></select><p class=error-text ng-if=add.isGood.$error.required&&add.isGood.$touched>选项为必填</p></div><div class=form-group ng-if="taskCtrl.task.isGood=='true'" ng-class="{'has-error':add.productCountLimit.$error.required&&add.productCountLimit.$touched}"><label>订单筛选</label><div class=input><div class=input-tit>订单金额</div><input type=text name=productCountLimit required class="input-text w50p" ng-model=taskCtrl.task.amountLimit><div class=input-tit>元</div></div><p class=error-text ng-if=add.amountLimit.$error.required&&add.amountLimit.$touched>选项为必填</p></div><div class=form-group ng-class="{'has-error':add.type.$error.required&&add.type.$touched}"><div class="col-xs-6 p0"><label>选择优惠方式</label><select name=type required class="form-control w200p" ng-model=taskCtrl.task.type><option selected hidden>请选择</option><option value=CUT>订单减免</option><option value=RANDOM_CUT>随机减免</option><option value=GIFT>订单赠品</option><option value=COUPON>优惠券</option></select><p class=error-text ng-if=add.type.$error.required&&add.type.$touched>选项为必填</p></div><div class="col-xs-6 p0" ng-if=!add.type.$error.required><label>优惠选项</label><select ng-model=taskCtrl.task.couponTemplateId class=form-control ng-options="a.id as a.name for a in taskCtrl.CouponList"><option>请选择</option></select><div class="panel panel-default panel-border" ng-if="taskCtrl.task.type=='RANDOM_CUT'"><div class=panel-heading><a href=javascript:; class="btn btn-primary" ng-click=taskCtrl.Addinterval()>添加</a> <span>ps:1元至5元总概率50%,总规则概率为100%</span></div><div class=panel-body><div class=admin-input-lyout ng-repeat="item in taskCtrl.interval"><div class=admin-input-title>规则:</div><div class=admin-input><input type=text ng-model=item.start> <span>元至</span> <input type=text ng-model=item.end> <span>元总概率</span> <input type=text ng-model=item.count> <span>%</span> <a href=javascript:; class="btn btn-red" ng-click=taskCtrl.Delinterval($index)>删除</a></div></div></div></div><div class="panel panel-default panel-border" ng-if="taskCtrl.task.type=='GIFT'"><div class=panel-heading>赠品列表</div><div class=panel-body><prems returnlist=taskCtrl.task.prems></prems></div></div></div></div></div></div><div class="panel panel-default panel-border" ng-if=false><div class=panel-heading>参与活动的对象及范围</div><div class=panel-body></div></div><div class="panel panel-default panel-border" ng-if=false><div class=panel-heading>参与区域</div><div class=panel-body></div></div><div class="panel panel-default panel-border" ng-if=false><div class=panel-heading>参与时间与次数</div><div class=panel-body><</div></div><div class="panel panel-default panel-border" ng-if=false><div class=panel-body></div></div><div class="panel panel-default panel-border" ng-show="taskCtrl.task.productType=='SELECTED_PRODUCT'" ng-if=false><div class=panel-body></div></div><div class="panel panel-default panel-border" ng-if=false><div class=panel-heading>活动促销方式</div><div class=panel-body></div></div><div class="panel panel-default panel-border" ng-if=false><div class=panel-heading>请选择优惠方式</div><div class=panel-body><div class=col-xs-12><div class=col-xs-2><div class=radio><label><input type=radio name=type value=CUT ng-change="hide=true;hide2=false;hide3=false;" ng-model=taskCtrl.task.type> 订单减免 <input type=number ng-disabled=!hide ng-model=taskCtrl.task.formulaParameter.cutAmount class=input_radio> 元</label></div><div class=radio><label><input type=radio name=type value=RANDOM_CUT ng-change="hide2=true;hide3=false;hide=false;" ng-model=taskCtrl.task.type> 随机减免</label></div><div class=radio><label><input type=radio name=type value=GIFT ng-model=taskCtrl.task.type> 订单赠品</label></div></div><div class=col-xs-10 ng-show="taskCtrl.task.type=='RANDOM_CUT'"><div class="panel panel-default panel-border"><div class=panel-heading><a href=javascript:; class="btn btn-primary" ng-click=taskCtrl.Addinterval()>添加</a> <span>ps:1元至5元总概率50%,总规则概率为100%</span></div><div class=panel-body><div class=admin-input-lyout ng-repeat="item in taskCtrl.interval"><div class=admin-input-title>规则:</div><div class=admin-input><input type=text ng-model=item.start> <span>元至</span> <input type=text ng-model=item.end> <span>元总概率</span> <input type=text ng-model=item.count> <span>%</span> <a href=javascript:; class="btn btn-red" ng-click=taskCtrl.Delinterval($index)>删除</a></div></div></div></div></div><div class=col-xs-10 ng-show="taskCtrl.task.type=='GIFT'"><div class="panel panel-default panel-border"><div class=panel-heading>赠品列表</div><div class=panel-body><prems returnlist=taskCtrl.task.prems></prems></div></div></div></div></div></div><div class="panel panel-default panel-border"><div class=panel-heading>活动成本承担方和承担比例 <a href=javascript:; class="btn btn-primary" ng-click=taskCtrl.AddcostSources()>添加</a> ps:承担比例总和为:100%</div><div class=panel-body><div class="input-group col-xs-5 mt10" ng-repeat="item in taskCtrl.task.costSources"><div class=input-group-addon>承担方选择</div><select name="{{'resource'+$index}}" required ng-class="{'error-input':add.{{'resource'+$index}}.$error.required&&add.{{'resource'+$index}}.$touched}" class=form-control ng-model=item.costSourceId ng-options="a.id as a.name for a in taskCtrl.resource" style=min-width:150px;><option selected>请选择</option></select><div class=input-group-addon>|&nbsp;&nbsp;承担比例</div><input type=text required class=form-control ng-class="{'error-input':add.{{'ratio'+$index}}.$error.required&&add.{{'ratio'+$index}}.$touched}" ng-model=item.ratio name="{{'ratio'+$index}}"><div class=input-group-addon>%</div><div class=input-group-btn><a href=javascript:; ng-click=taskCtrl.DelcostSources() class="btn btn-red">删除</a></div><div class=table-row><p class=d_cell></p><p class="d_cell error-text"><span ng-show="add.{{'resource'+$index}}.$error.required&&add.{{'resource'+$index}}.$touched">选项为必填</span></p><p class=d_cell></p><p class="d_cell error-text"><span ng-show="add.{{'ratio'+$index}}.$error.required&&add.{{'ratio'+$index}}.$touched">内容不能为空</span></p></div></div></div></div><div class="col-xs-12 taskBtn"><button href=javascript:; class="btn btn-primary">保存</button> <a href=javascript:; class="btn btn-primary" onclick=history.go(-1)>返回</a></div></div></form>